/////////////////////////////////////////////////////////////////////////////
// Project ePamms
//
// This is a part of the ePamms applications package.
// Copyright (c) 2007 - 2016 Arksoft, Inc.
// All Rights Reserved.
//
// SUBSYSTEM:    wWebXfer      - Transfer Work Area operations
// FILE:         wWebXfer.vml
// AUTHOR:       Doug Sorensen
//
/////////////////////////////////////////////////////////////////////////////

/////////////////////////////////////////////////////////////////////////////
//
//  OPERATION: dFullNameLFM
//
/////////////////////////////////////////////////////////////////////////////
DERIVED ATTRIBUTE OPERATION
dFullNameLFM( VIEW wWebXfer BASED ON LOD wWebXfer,
              STRING ( 32 ) InternalEntityStructure,
              STRING ( 32 ) InternalAttribStructure,
              SHORT GetOrSetFlag )

   CASE GetOrSetFlag
   OF   zDERIVED_GET:
        PersonName_LastFirstMiddle( wWebXfer, InternalEntityStructure,
                                    InternalAttribStructure, GetOrSetFlag )

        /* end zDERIVED_GET */
   OF   zDERIVED_SET:

        /* end zDERIVED_SET */
   END  /* case */

END

/////////////////////////////////////////////////////////////////////////////
//
//  OPERATION: dFullNameFML
//
/////////////////////////////////////////////////////////////////////////////
DERIVED ATTRIBUTE OPERATION
dFullNameFML( VIEW wWebXfer BASED ON LOD wWebXfer,
              STRING ( 32 ) InternalEntityStructure,
              STRING ( 32 ) InternalAttribStructure,
              SHORT GetOrSetFlag )

   CASE GetOrSetFlag
   OF   zDERIVED_GET:
        PersonName_FirstMiddleLast( wWebXfer, InternalEntityStructure,
                                    InternalAttribStructure, GetOrSetFlag )
        /* end zDERIVED_GET */
   OF   zDERIVED_SET:

        /* end zDERIVED_SET */
   END  /* case */

END

/////////////////////////////////////////////////////////////////////////////
//
//  OPERATION: dCurrentDate
//
/////////////////////////////////////////////////////////////////////////////
DERIVED ATTRIBUTE OPERATION
dCurrentDate( VIEW wWebXfer BASED ON LOD wWebXfer,
              STRING ( 32 ) InternalEntityStructure,
              STRING ( 32 ) InternalAttribStructure,
              SHORT GetOrSetFlag )

   STRING (  18  ) szDate

   CASE GetOrSetFlag
      OF zDERIVED_GET:

         szDate = wWebXfer.Root.dCurrentDateTime
         StoreStringInRecord( wWebXfer, InternalEntityStructure, InternalAttribStructure, szDate )

        /* end zDERIVED_GET */
   OF   zDERIVED_SET:

        /* end zDERIVED_SET */
   END  /* case */

END

/////////////////////////////////////////////////////////////////////////////
//
//  OPERATION: dCurrentDateTime
//
/////////////////////////////////////////////////////////////////////////////
DERIVED ATTRIBUTE OPERATION
dCurrentDateTime( VIEW wWebXfer BASED ON LOD wWebXfer,
                  STRING ( 32 ) InternalEntityStructure,
                  STRING ( 32 ) InternalAttribStructure,
                  SHORT GetOrSetFlag )

   STRING (  18  ) szDateTime

   CASE GetOrSetFlag
      OF zDERIVED_GET:

         SysGetDateTime( szDateTime )
         StoreStringInRecord( wWebXfer, InternalEntityStructure, InternalAttribStructure, szDateTime )
      /* end zDERIVED_GET */
      OF zDERIVED_SET:

      /* end zDERIVED_SET */
   END  /* case */

END

/////////////////////////////////////////////////////////////////////////////
//
//  OPERATION: dColumnCnt
//
/////////////////////////////////////////////////////////////////////////////
DERIVED ATTRIBUTE OPERATION
dColumnCnt( VIEW wWebXfer BASED ON LOD wWebXfer,
            STRING ( 32 ) InternalEntityStructure,
            STRING ( 32 ) InternalAttribStructure,
            SHORT GetOrSetFlag )

   STRING ( 32 ) Count
   INTEGER nCols

   CASE GetOrSetFlag
   OF   zDERIVED_GET:

      nCols = CountEntitiesForView( wWebXfer, "Work" )
 
      // Store the resulting value in the object.
      Count = nCols
      StoreStringInRecord( wWebXfer, InternalEntityStructure, InternalAttribStructure, Count )
      RETURN 0

        // end zDERIVED_GET
   OF   zDERIVED_SET:

        // end zDERIVED_SET
   END  // case

END
